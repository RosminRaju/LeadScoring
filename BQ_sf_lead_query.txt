select
	leads.lead_type__c,
	leads.company,
	leads.tenant_id__c,
	leads.leadsource,
	leads.order_id__c,
	leads.lead_owner_full_name__c,
	leads.original_lead_owner__c,
	leads.device_type__c,
	leads.number_of_products_selling__c,
	leads.reason_not_qualified__c,
	leads.sms_opt_in__c,
	leads.timezone_editable__c,
	leads.timezone__c,
	leads.industry__c,
	leads.socialsignup__c,
	leads.gender__c ,
	leads.last_login_from_admin__c,
	leads.have_products__c,
	leads.position__c,
	leads.country,
	leads.status,
	leads.createddate as lead_createdate,
	leads.isconverted as converted_to_opp,
	opps.createddate as opp_createdate,
	opps.iswon,
	opps.closedate
from
	`v1-dev-main.salesforce.vw_leads` as leads
left join
	`v1-dev-main.salesforce.vw_opportunities` as opps on
	cast(leads.convertedopportunityid as string) =  cast(opps.id as string)
where
	leads.leadsource in ('v2 sales', 'v1 sales')
order by
	leads.createddate desc